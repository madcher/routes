(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{17:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var a=n(1),s=n.n(a),c=n(8),o=n.n(c),i=n(2),l=n(0),r=function(t){var e=t.setToken;return Object(l.jsxs)("div",{className:"header",children:[Object(l.jsx)("div",{className:"header__label",children:"Route Tracker"}),Object(l.jsx)("div",{children:Object(l.jsx)("button",{className:"header__logout",onClick:function(){return e(!1)},children:"Log out"})})]})},u=function(t){var e=t.point;return Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{children:"\u041d\u043e\u043c\u0435\u0440: ".concat(e.carid)}),Object(l.jsx)("div",{children:"\u0412\u0440\u0435\u043c\u044f: ".concat(new Date(e.datetime).toLocaleString())})]})},j=n(20),d=n(23),h=n(21),b=n(22),p=n(4),m=n.n(p);n(17);m.a.Icon.Default.imagePath="https://unpkg.com/leaflet@1.5.0/dist/images/";var O=function(t){var e=t.state,n=t.setMap,a=t.points,s=[e.lat,e.lng];return Object(l.jsxs)(j.a,{zoom:e.zoom,center:s,whenCreated:n,children:[Object(l.jsx)(d.a,{url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"}),a.map((function(t){return Object(l.jsx)(h.a,{position:[t.lat,t.lng],children:Object(l.jsx)(b.a,{children:Object(l.jsx)(u,{point:t})})},t.datetime)}))]})},f=function(){return Object(l.jsxs)("svg",{id:"regular","enable-background":"new 0 0 24 24",height:"24",viewBox:"0 0 24 24",width:"24",fill:"#6b7070",xmlns:"http://www.w3.org/2000/svg",children:[Object(l.jsx)("path",{d:"m12 22c-5.514 0-10-4.486-10-10s4.486-10 10-10 10 4.486 10 10-4.486 10-10 10zm0-18.5c-4.687 0-8.5 3.813-8.5 8.5s3.813 8.5 8.5 8.5 8.5-3.813 8.5-8.5-3.813-8.5-8.5-8.5z"}),Object(l.jsx)("path",{d:"m12 5c-.414 0-.75-.336-.75-.75v-3.5c0-.414.336-.75.75-.75s.75.336.75.75v3.5c0 .414-.336.75-.75.75z"}),Object(l.jsx)("path",{d:"m23.25 12.75h-3.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h3.5c.414 0 .75.336.75.75s-.336.75-.75.75z"}),Object(l.jsx)("path",{d:"m12 24c-.414 0-.75-.336-.75-.75v-3.5c0-.414.336-.75.75-.75s.75.336.75.75v3.5c0 .414-.336.75-.75.75z"}),Object(l.jsx)("path",{d:"m4.25 12.75h-3.5c-.414 0-.75-.336-.75-.75s.336-.75.75-.75h3.5c.414 0 .75.336.75.75s-.336.75-.75.75z"}),Object(l.jsx)("path",{d:"m12 15c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3zm0-4.5c-.827 0-1.5.673-1.5 1.5s.673 1.5 1.5 1.5 1.5-.673 1.5-1.5-.673-1.5-1.5-1.5z"})]})};var g=function(){this.onmessage=function(t){t.data;var e=new WebSocket("ws://localhost:8888");e.onopen=function(){postMessage({hint:"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e"})},e.onclose=function(t){t.wasClean?postMessage({hint:"\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u043e \u0447\u0438\u0441\u0442\u043e"}):postMessage({hint:"\u041e\u0431\u0440\u044b\u0432 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f"}),postMessage({hint:"\u041a\u043e\u0434: "+t.code+" \u043f\u0440\u0438\u0447\u0438\u043d\u0430: "+t.reason})},e.onmessage=function(t){postMessage({message:t.data})},e.onerror=function(t){postMessage({error:"\u041e\u0448\u0438\u0431\u043a\u0430 "+t.message})}}},x=function(t,e){fetch("/api/get",{method:"GET",headers:{token:e}}).then((function(t){return t.json()})).then((function(e){t(e)})).catch((function(t){return console.log(t)}))},v={lat:55.702868,lng:37.530865,zoom:10},_=[55.702868,37.530865],w=function(t){var e=t.callback;return Object(l.jsx)("div",{className:"map-menu",children:Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault();var n=new FormData(t.target),a=n.get("lat"),s=n.get("lng"),c=n.get("uid");s&&a&&c?e({lat:a,lng:s,carId:c}):alert("add all fields")},className:"addpoint-form",children:[Object(l.jsx)("label",{className:"auth__label",children:"Uid"}),Object(l.jsx)("input",{className:"auth__input",type:"text",placeholder:"",name:"uid"}),Object(l.jsx)("label",{className:"auth__label",children:"Latitude"}),Object(l.jsx)("input",{className:"auth__input",type:"text",placeholder:"",name:"lat"}),Object(l.jsx)("label",{className:"auth__label",children:"Longitude"}),Object(l.jsx)("input",{className:"auth__input",type:"text",placeholder:"",name:"lng"}),Object(l.jsx)("button",{type:"submit",className:"auth__input auth_button",children:"Add"})]})})},N=function(t){var e=t.token,n=Object(a.useState)(v),s=Object(i.a)(n,2),c=s[0],o=(s[1],Object(a.useState)(null)),r=Object(i.a)(o,2),u=r[0],j=r[1],d=Object(a.useState)([]),h=Object(i.a)(d,2),b=h[0],p=h[1];Object(a.useEffect)((function(){x(p,e)}),[]),Object(a.useEffect)((function(){if(b.length){var t=b[b.length-1],e=[t.lat,t.lng];u.flyTo(e,10)}}),[b]);var m=function(){console.log("ssss"),x(p,e)};Object(a.useEffect)((function(){!function(t){var e=new Blob([("("+g+")();").replace('"use strict";',"")]),n=(window.URL?window.URL:window.webkitURL).createObjectURL(e,{type:"application/javascript; charset=utf-8"}),a=new Worker(n);a.postMessage({addThis:{num1:1,num2:10}}),a.onmessage=function(e){var n=e.data,a=n.error,s=(n.hint,n.message);a&&alert(a),s&&(console.log(s),t())}}(m)}),[]);return Object(l.jsxs)("div",{className:"content",children:[Object(l.jsx)(w,{callback:function(t){!function(t,e,n){fetch("/api/addpoint",{method:"POST",headers:{token:n,"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)}).then((function(t){x(e,n)})).catch((function(t){return console.log(t)}))}(t,p,e)}}),Object(l.jsxs)("div",{className:"center-menu",children:[Object(l.jsx)("div",{children:Object(l.jsx)(f,{})}),Object(l.jsx)("div",{children:Object(l.jsx)("button",{type:"button",className:"auth__input auth_button",onClick:function(){u.flyTo(_,10)},children:"go"})})]}),Object(l.jsx)("div",{id:"mapid",children:Object(l.jsx)(O,{state:c,setMap:j,points:b})})]})},k=function(t){var e=t.setToken,n=Object(a.useState)(!1),s=Object(i.a)(n,2),c=s[0],o=s[1];return Object(l.jsx)("div",{className:"auth__container",children:Object(l.jsxs)("form",{className:"auth__form",onSubmit:function(t){t.preventDefault(),function(t,e,n){var a=new FormData(t.target),s=a.get("login"),c=a.get("password");console.log(s,c),fetch("/api/authorization",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({login:s,password:c})}).then((function(t){if(!t.ok)throw console.log("HTTP status "+t.status),Error;return t.json()})).then((function(t){e(t.token),n(!1)})).catch((function(t){n(!0),console.log(t)}))}(t,e,o)},children:[Object(l.jsx)("label",{className:"auth__label",children:"Login"}),Object(l.jsx)("input",{className:"auth__input",type:"text",placeholder:"login",name:"login"}),Object(l.jsx)("label",{className:"auth__label",children:"Password"}),Object(l.jsx)("input",{className:"auth__input",type:"password",placeholder:"",name:"password"}),c&&Object(l.jsx)("div",{className:"auth_error",children:"Invalid login or password"}),Object(l.jsx)("button",{type:"submit",className:"auth__input auth_button",children:"Submit"})]})})},y=function(){var t=Object(a.useState)(null),e=Object(i.a)(t,2),n=e[0],s=e[1];return n?Object(l.jsxs)("div",{children:[Object(l.jsx)(r,{setToken:s}),Object(l.jsx)(N,{token:n})]}):Object(l.jsx)(k,{setToken:s})};o.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(y,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.41384c2a.chunk.js.map