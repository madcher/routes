{"version":3,"sources":["components/Header.js","components/Map.js","serviceWorker.js","services/service.js","components/Content.js","components/Auth.js","App.js","index.js"],"names":["Header","setToken","className","onClick","MapComponent","useEffect","L","window","mymap","map","setView","tileLayer","attribution","addTo","Routing","control","addWaypoints","draggableWaypoints","fitSelectedRoutes","collapsible","show","waypoints","latLng","id","workerFunction","addPoint","query","setPoints","token","fetch","method","headers","body","JSON","stringify","then","res","response","json","data","catch","err","console","log","getPoints","blob","Blob","this","onmessage","wsConnection","WebSocket","onopen","postMessage","hint","onclose","event","wasClean","code","reason","evt","message","onerror","error","replace","blobURL","URL","webkitURL","createObjectURL","type","Content","myWorker","Worker","addThis","num1","num2","alert","Notification","permission","requestPermission","Map","Auth","useState","setError","onSubmit","e","preventDefault","FormData","target","login","get","password","ok","status","Error","result","loginFunc","placeholder","name","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.9d9012a9.chunk.js","sourcesContent":["import React from 'react';\n// шапка страницы\nconst Header = ({setToken}) => {\n    return (\n        <div className=\"header\">\n            <div className=\"header__label\">Route Tracker</div>\n            <div><button className=\"header__logout\" onClick={() => setToken(false)}>Log out</button></div>\n        </div>\n    );\n}\n\nexport default Header;","import React, {useEffect} from 'react';\n\nconst MapComponent = () => {\n    useEffect(() => {\n        const L = window.L;\n        const mymap = L.map('mapid').setView([55.755826, 37.6173], 13);\n        // url of tiles z - zoom , x - latitude, y - longitude\n        const tileUrl = 'https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png';\n        // tiles\n        const tiles = L.tileLayer(tileUrl, {attribution: 'mymap'});\n        tiles.addTo(mymap);\n        L.Routing.control({      addWaypoints: false,\n            draggableWaypoints: false,\n            fitSelectedRoutes: false,\n            collapsible: false,\n            show: false,\n            waypoints: [\n                L.latLng(55.755826, 37.6173),\n                L.latLng(55.855826, 37.8173),\n                L.latLng(55.955826, 37.9179)\n            ]\n        }).addTo(mymap);\n    }, []);\n    return (\n        <div id=\"mapid\"></div>\n    );\n};\n\nexport default MapComponent;","function workerFunction() {\n    var self = this;\n    self.onmessage = function({data}) {\n        const wsConnection = new WebSocket(\"ws://localhost:8888\");\n    \n        // web socket\n        wsConnection.onopen = function() {\n            postMessage({hint: 'Соединение установлено'});\n        };\n    \n        wsConnection.onclose = function(event) {\n            if (event.wasClean) {\n                postMessage({hint: 'Соединение закрыто чисто'});\n            } else {\n                // например, \"убит\" процесс сервера\n                postMessage({hint: 'Обрыв соединения'});\n            }\n            postMessage({hint: 'Код: ' + event.code + ' причина: ' + event.reason});\n        };\n    \n        wsConnection.onmessage = evt => {\n            // отправляем сообщение в основной поток\n            postMessage({message: evt.data});\n        }\n    \n        wsConnection.onerror = function(error) {\n            postMessage({error: \"Ошибка \" + error.message});\n        };\n    }\n}\n\nexport default workerFunction;\n\n\n\n\n\n","// функция авторизации\nexport const loginFunc = (e, setToken, setError) => {\n    const data = new FormData(e.target);\n    const login = data.get('login');\n    const password = data.get('password');\n    console.log(login, password);\n    fetch('/api/authorization', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json;charset=utf-8'\n        },\n        body: JSON.stringify({ login, password }),\n    }).then(res => {\n        if (!res.ok) {\n            console.log(\"HTTP status \" + res.status);\n            throw Error;\n        }\n        return res.json();\n    }).then(result => {\n        setToken(result.token);\n        setError(false);\n    }).catch(err => {\n        setError(true);\n        console.log(err)\n    });\n};\n\n// получение маршрутов\nexport const getPoints = (setPoints, token) => {\n    fetch('/api/get-courses', {\n        method: 'GET',\n        headers: {'token': token}\n    }).then(response => response.json()).then(data => {\n        setPoints(data);\n    }).catch(err => console.log(err));\n}\n// добавление точки\nexport const addPoint = (query, setPoints, token) => {\n    fetch('/api/addpoint', {\n        method: 'POST',\n        headers: {'token': token, 'Content-Type': 'application/json;charset=utf-8'},\n        body: JSON.stringify(query)\n    }).then(res => {\n        getPoints(setPoints, token);\n    }).catch(err => console.log(err));\n}\n","import React, {useEffect} from 'react';\nimport Map from './Map';\nimport workerFunction from '../serviceWorker';\nimport { addPoint } from '../services/service';\n\nvar dataObj = '(' + workerFunction + ')();'; // here is the trick to convert the above fucntion to string\nvar blob = new Blob([dataObj.replace('\"use strict\";', '')]); // firefox adds \"use strict\"; to any function which might block worker execution so knock it off\n\nvar blobURL = (window.URL ? window.URL : window.webkitURL).createObjectURL(blob, {\n    type: 'application/javascript; charset=utf-8'\n});\n\n// содержания страницы\nconst Content = ({token}) => {\n    useEffect(() => {\n        const myWorker = new Worker(blobURL);\n        //const myWorker = new Worker('serviceWorker.js');\n        const message = { addThis: {num1: 1, num2: 10} };\n        myWorker.postMessage(message);\n        myWorker.onmessage = ({data}) => {\n            const {error, hint, message} = data;\n            if (error) {\n                alert(error);\n            }\n            if (hint) {\n                console.log(hint);\n            }\n            if (message) {\n                console.log(message);\n                // создаем уведомление\n                if (Notification.permission === \"granted\") {\n                    // Если разрешено, то создаем уведомление\n                    var notification = new Notification(message);\n                } else if (Notification.permission !== 'denied') {\n                    Notification.requestPermission(function (permission) {\n                        // Если пользователь разрешил, то создаем уведомление\n                        if (permission === \"granted\") {\n                            var notification = new Notification(message);\n                        }\n                    });\n                }\n            }\n        }\n        \n    }, []);\n\n    const setPoints = () => {\n        console.log('set points');\n    };\n\n\n    const addPointHandler = () => {\n        const data = {\n            \"lat\": 56.855826, \n            \"lng\": 38.8173,\n            \"carId\": 1\n        };\n\n        addPoint(data, setPoints, token);\n    };\n    \n    return (\n        <div className=\"content\">\n            <div className=\"map-menu\">\n                <div>New point</div>\n                <div>\n                    <button type=\"button\" className=\"auth__input auth_button\" onClick={addPointHandler}>Add point</button>\n                </div>\n            </div>\n            <div className=\"center-menu\">\n                <div>Go to center</div>\n                <div>\n                    <button type=\"button\" className=\"auth__input auth_button\" onClick={() => {}}>go</button>\n                </div>\n            </div>\n            <Map/>\n        </div>\n    );\n}\n\nexport default Content;","// страница авторизации\nimport React, {useEffect, useState} from 'react';\nimport { loginFunc } from '../services/service';\n\nconst Auth = ({setToken}) => {\nconst [error, setError] = useState(false);\nconst submitHandler = (e) => {\n    e.preventDefault();\n    loginFunc(e, setToken, setError)\n};\n\nreturn(<div className=\"auth__container\">\n        <form className=\"auth__form\" onSubmit={submitHandler}>\n            <label className=\"auth__label\">Login</label>\n            <input className=\"auth__input\" type=\"text\" placeholder=\"login\" name=\"login\"/>\n            <label className=\"auth__label\">Password</label>\n            <input className=\"auth__input\" type=\"password\" placeholder=\"\" name=\"password\"/>\n            {error && <div className=\"auth_error\">Invalid login or password</div>}\n            <button type=\"submit\" className=\"auth__input auth_button\">Submit</button>\n        </form>\n    </div>);\n}\n\nexport default Auth;","import React, { useState } from 'react';\nimport Header from './components/Header';\nimport Content from './components/Content';\nimport Auth from './components/Auth';\n\n// компонент приложения\nconst App = () => {\n    const [token, setToken] = useState(null);\n    if (!token) {\n        return (<Auth setToken={setToken} />)\n    }\n    return(<div>\n            <Header setToken={setToken}/>\n            <Content token={token}/>\n        </div>);\n}\n\nexport default App;\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}